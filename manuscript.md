## (2st) 円滑なUI＆機能実装やデザイナーとの共同作業を進めるために心がけてきた事

### はじめに

皆様こんにちは、酒井文也 (@fumiyasac)と申します。

私はこれまでのiOSアプリ開発において、主にUIKitを利用したUI実装とそれに付随する機能開発を担当する機会が多くあり、また直近数年間に私が経験してきた中では、機能を実現するための実装だけではなく、デザイナーをはじめ様々な職種の方々を巻き込みつつもデザインも絡めた仕様部分から考え抜く機会にも多く恵まれたようにも感じております。
本稿では、チームの皆様（プロダクトマネージャー/デザイナー/エンジニア）を巻き込みながら、アプリUI実装と機能ロジックをコラボして仕上げていく際に、私自身が心がけている習慣やポイント、そして着眼点等をご紹介できればと考えております。

決して特別な事はありませんが、ほんの少しでも皆様のご参考になる事ができれば嬉しく思います。

### 仕様のイメージをすり合わせるために書き出してみよう

私自身がまず心がけている習慣としましては、新機能の実装時や既存機能の改修対応をする際において特にデザイン要素の調整や変更を伴う開発をする際の設計及び仕様相談ミーティングの場合や平素のスクラムイベントの中でアプリの仕様策定に関わりうるものについては、議事録とは別に自分なりにミーティングの要点やポイントを簡単にまとめたメモを自分で取る様に心がけています。エンジニアをする前にデザイナーをしていた当時から実践していた絵コンテを書いてから実作業をするようにしていた習慣の延長線上で、ミーティング中のメンバーとの会話と並行しながら、聞き取った会話の内容やここは重要そうだと思われる部分等をノートとペンでまとめ上げていく様な形のものになります。

その中で私が意識しているポイントとして、

- デザインデータ・仕様書・その他資料等を読み合わせた際に出てきた疑問点は何か？
- 機能ロジックとUI実装をしていく際に自分が怖そうと感じる部分があるか？
- デザインデータの内容を見た際に自分の中で画面遷移図が描けるか？
- メンバーとの会話の中で盛り上がった(関心が向いている部分)はどこか？
- 議論が脱線してしまったり決めたい部分が未決定のままになっていないか？

等の部分については、特に注意深く気を配るようにしています。

この様な活動は、自分自身がデザインデータ・仕様書・その他資料等を読み合わせた際に出てきたポイントや疑問点、そして会話の中でのポイントになりうる点をキャッチアップできているかの確認の意味合いももちろんありますが、議事録だけでは掴みにくい会話を元にした議論の流れをできるだけ言語化しておく様な状態にすることで後から理解できる様にしておけばチームメンバーの役に立てるのではないかと思い今日まで継続しているものです。

![attachment_note01.png](:storage/26943a73-7b6e-4931-a019-1ab845843dc9/230cb417.png)

![attachment_note02.png](:storage/26943a73-7b6e-4931-a019-1ab845843dc9/6551da59.png)

個人的な所感としましては、チームメンバーと一緒に開発を進めていく中でペア作業を実施する場面やiOSとAndroid両方のアプリに対して改修を実施する場合でも役に立つことが多くありました。実装段階でOS間でのUI構造の違いや共通点にも気がつく事ができることでエンジニア側からも提案を投げかける等の歩み寄りをする機会も増えたのではないかと感じています。

### デザインデータから実装における勘所を紐解く

iOSアプリ開発におけるUI実装を形にする工程においてファースト・コンタクトとなる部分はFigmaやAdobeXD等をはじめとしたツールで作成されたデザインになるかと思います。昨今のデザインツールでは、デザイナーとエンジニア間での活発なコミュニケーションを促すための機能をすでに備えているので、配置要素に関する情報や画面遷移フロー図解と共に、

- デザインを見た際に気をつけられそうな部分
- さらにもう一段「深く読んでみて」気をつけられそうな部分
- 想定する機能を利用した場合の初めから終わりまでの流れや一連のストーリーとの整合性

等の観点に目を向けることはもちろんですが、これに加えてデザインの中では表現することが難しいアニメーションやインタラクションに関する部分の感覚をすり合わる必要がある場合もあります。この様な時には動作感を含めて試す事ができる試作品を元にフィードバックを反映する過程を繰り返す形で調整をかけていく様にすると、認識をそろえやすくできるのではないかと思います。

![design_himotoki01.png](:storage/26943a73-7b6e-4931-a019-1ab845843dc9/c57d75d6.png)

![design_himotoki02.png](:storage/26943a73-7b6e-4931-a019-1ab845843dc9/bddf9425.png)

![design_himotoki03.png](:storage/26943a73-7b6e-4931-a019-1ab845843dc9/bba2e188.png)

UI実装・画面遷移・アニメーション・操作時の手触り感に関するチェックに関してはデザイナーとの協力が不可欠な部分でもあると私自身も感じており、特にデザインと実装とのつなぎ目になりうる部分についてはコミュニケーション面でも連携が必要になる部分と考えておりますので、デザインに対するエンジニア観点からのフィードバックをする際においても少しでも「お互いが優しい気持ちになれる」状態を作り出すための準備や配慮についても自分なりにはなってしまいますが、可能な限りこだわる様に注意しています。

### 自前で準備する？ライブラリを使う？の切り分けと判断

まず前提として、自作するかライブラリを使うかの判断に関しては、どちらを選択するかの決め手なるポイントは設計はもちろんプロジェクトの事情等により変化するものなので、「これが良い！」とは断言しにくい部分ではあると思いますし、開発しているプロダクトの規模等によっても変わってくると思います。

ここでは、その事例として「Webでは頻出での表現をiOSアプリで実現する際に気をつけている事」について簡単ではありますが触れていきたいと思います。

##### Webでは頻出での表現をiOSアプリで実現する際に気をつけている事

アプリ開発におけるUI表現を考えていく際には、近しい機能を持つiOS/Androidアプリを参考とする場合が多いかと思いますが、機能等によってはWebでよくお目にかかる形からヒントを得ることもあります。この様な場合は個人的には気をつける様にしています。

特にWebサイト等ではポピュラーですぐに実現可能な表現であったとしても、アプリ側では同じ感覚ですぐに実現ができるとは限らない事や、可能ではあるが自前で実装する場合には想定以上の工数がかかってしまう様な場合もしばしばあるかと思います。

その様なUI実装を実現したい場合の候補としてピックアップできる様なサードパーティー製のライブラリの事例と共に実装時の難しさを感じてしまうポイントをご紹介できればと思います。

##### 長文の中にメンション・ハッシュタグ・URLリンクが混在する様な形を実現する場合

- ActiveLabel.swift
  https://github.com/optonaut/ActiveLabel.swift

![libraries_example01.png](:storage/26943a73-7b6e-4931-a019-1ab845843dc9/fa6e512f.png)

##### 星形レーティングを表示を実現する場合

- Cosmos
  https://github.com/evgenyneu/Cosmos

![libraries_example02.png](:storage/26943a73-7b6e-4931-a019-1ab845843dc9/128fe9f8.png)

##### Markdown形式のテキスト表示を利用する場合

- SwiftyMarkdown
  https://github.com/SimonFairbairn/SwiftyMarkdown

読み物系コンテンツ等で長めの文章表示をする場合において、Markdown形式のテキストを表示をある程度のスタイルを考慮した状態でiOSアプリ上で表示する場合には、「SwiftyMarkdown」の利用を検討しても良さそうに思います。

余談として、執筆時点ではまだβ版ではありますが、iOS15からはAttributedTextの設定においてMarkdownがサポートされる様になるので、更にテキスト表現の幅がこれからも広がっていく期待も個人的には感じています。

https://developer.apple.com/documentation/foundation/attributedstring/3796160-init

##### 注釈等の用途で利用するTooltipを実現する場合 

- EasyTipView
  https://github.com/teodorpatras/EasyTipView

Webサイトで補足や注釈説明を特定のエリアに表示する際に利用されるTooltipの様な表示をiOSアプリで実現する場合には、「EasyTipView」利用を検討しても良さそうに思います。

ただし、UITableView / UICollectionViewを利用して表示する様な場合においては、

- スクロールを実行するとセルのリサイクルが発生してしまう点
- 対象セルに対しての細かな表示位置調整をするための実装が必要になる点

に注意しながら実装や検討を進める必要があるとも個人的には感じております。

この様にWebでもよく用いられるUI表現を参考にする場合においては、スマートフォン対応のWebサイトにおけるUI実装とネイティブアプリでのUI実装を比べた上で、この表現はアプリでもよく用いられる形のものか？という点に気をつけながら判断していく事がポイントになると思いますので、自前での実装手段を考えていくと同時にUI実装用のライブラリを活用するといった選択肢を視野に入れた上で検討していくと良さそうに思います。

### 機能ロジックとUI実装を合わせる際に違和感を感じた場合の働きかけ

紹介した事例以外にも、UI実装と機能ロジックを合わせていく際に実装を組み立てていく途中段階において違和感を覚えてしまう場面に遭遇する事はしばしば経験すると思いますし、私自身も例に違わずこの様な経験して焦ってしまう事がよくあります。その様な時には、ある程度組み立てた時点で感じた懸案事項や不安要素等を可能な限り言語化し、説明と共有ができる形を常に作っておく様にすることで、これまでのデザインや機能に対して軌道修正をせざるを得ない場合でも立て直しのための議論をスムーズにすることができるかと思います。

### Androidアプリで良くお目にかかるUI表現をiOSアプリで実現する場合の勘所

ここからは少し趣向を変えて、iOS/AndroidアプリにおけるUIのテイストをできるだけ合わせていく方針をとる場合についても触れたいと思います。

デザインの統一感を意識していく際にもHuman Interface Guideline・Material Design両方のガイドラインを意識しながら考えていく必要がある点や、iOSアプリのデザインをMaterial Designに近しい形に寄せていく方針を取る場合であったとしてもガイドラインと合わせて不自然にならないように配慮しなければならない点にその難しさがある部分だと認識しています。一見すると似ているような印象を持つ機能やデザインであったとしても、実現方法やUI実装における考え方は全く異なる場合があるので、その部分に対しても改めて一歩踏み込んだ上で細かな点を注意深く見る様にすると、実装段階で配慮すべき点が明らかにできる場面もある様に思います。

また、FlutterやReactNativeといったクロスプラットフォームを利用したアプリ開発におけるUI実装を考えていく場合においても同様に、iOS/Android間におけるUI表現の違いや「ネイティブアプリらしさの実現におけるポイント」について理解をしておくことは、ネイティブアプリでの開発時同様にとても有意義であると感じています。

1つのコードベースの中でiOS/Android両方のガイドラインにできるだけ合わせながら両方のOSに対応する形でのデザインを考えていかなければならない点に大変と難しさにその難しさがありますが、アプリの使い勝手や馴染むデザインを考えていく際には意識をしておいて決して損はないと思います。

Flutterでは「Cupertino UI」が純正Widgetとして提供されていたり、ReactNativeにおいても「NativeBase」の様なライブラリがあるので、iOS/Android間におけるデザインを意識したUI実装を考える際には参考にしてみても良いかもしれません。

- NativeBase (※NativeBase)
  https://nativebase.io/
- Cupertino Widgets (※Flutter)
  https://flutter.dev/docs/development/ui/widgets/cupertino

##### 配置したヘッダー画像がスクロールに合わせて伸縮する様なレイアウト例 

![android_resemble01.png](:storage/26943a73-7b6e-4931-a019-1ab845843dc9/26995bf3.png)

Androidで類似した表現を実現する場合には「CoodiatorLayout」を利用することで関連する各種View要素の大きさや位置の調整をする様な形になりますが、iOSではこの部分をUIScrollViewDelegateを利用してスクロールの変化量をキャッチして関連する各種View要素に変化を与える形の実装となる点が大きく異なる部分かと思います。また、サムネイル画像部分におけるパララックス（視差効果）表現部分についてはライブラリを利用したり、またはその挙動や振る舞い等を参考にしながら実装を考えていく形にしても良いかもしれません。

- ParallaxHeader
  https://github.com/romansorochak/ParallaxHeader

##### タブ型の一覧表示＆スワイプをして画面を切り替える様なレイアウト例

![android_resemble02.png](:storage/26943a73-7b6e-4931-a019-1ab845843dc9/19343b78.png)

Androidで類似した表現を実現する場合には「ViewPagerとTabLayoutの組み合わせ」を利用することで図解に示した様な形を実現することができますが、iOSではUIPageViewControllerでのコンテンツ一覧表示をベースとした上で、タブ表示部分についてはUIScrollViewやUICollectionViewを利用する方針となる場合が多いかと思います。そしてタブ表示部分のデザイン的な見せ方の部分等でも工夫の余地がある一方で、自前で細かな部分までこだわったUI実装をする場合にはなかなか骨の折れる部分でもあります。現在では割とポピュラーなUI表現にもなってきていることもあり、この様な形を実現する有名なライブラリもあるので、自前での実装が難しい場合はライブラリに合わせた方針を取ることを検討をしてみるのも良さそうです。

- Parchment
  https://github.com/rechsteiner/Parchment

前述した画面レイアウトに関する例とは少し異なりますが、Androidアプリ内で良く見かけるUIコンポーネントでBottomSheetとFloatingActionButtonを例に、もしiOSで同様な表現を実装しようと考えた場合に、題意を満たす様な表現をUIライブラリを利用した実装例も簡単に紹介できればと思います。

##### AndroidでのFloating Action Buttonに相当する様な実装例

![android_library01.png](:storage/26943a73-7b6e-4931-a019-1ab845843dc9/2a7752fc.png)

- Floaty
  https://github.com/kciter/Floaty

##### AndroidでのBottom Sheetに相当する様な実装例

![android_library02.png](:storage/26943a73-7b6e-4931-a019-1ab845843dc9/937a78d3.png)

- PanModal
  https://github.com/slackhq/PanModal

私の場合は、AndroidアプリこうするけれどもiOSアプリではではどうする？(またはその逆も然り)という視点で実装のイメージやアイデアを紐解くために、

- iOS/Androidアプリで頻出のUI表現に関する調査
- よく利用されるライブラリと活用事例

という観点を特に注意しながら、UI実装時のヒントを探る様にしています。

Androidでは良く見かける表現やAndroid特有の特徴的なComponentを利用している部分は、技術的には実現可能であったとしても片方のOSではあまりお目にかからないUI表現であるケースもあるので、両OSでのガイドラインを見比べると共に参考にするアプリにおいてもiOS/Android版を見比べながら調査をする様な形にすると、より良い判断や選択ができると思います。

### おわりに

本稿でここまでにご説明してきた部分はコードでの実装そのものというよりも、前準備の段階における自分なりのアプローチ手段になるかと思います。特にプロダクトマネージャー/デザイナー/エンジニア/QA等の様々な役割を持ったメンバーが1つのチームとなって関わり合う様な形をとっている場合には、アプリUI実装と機能ロジックを一緒に考えていく必要があると共に、技術的に実現が難しそうな部分やデザインの状態を完璧に再現しようとした際に複雑な実装を伴う可能性がある部分を、時間の制約がある中でもきるだけ早い段階で明らかにしなければいけない様な場面はたくさんあるかと思います。

その様な状況でもチームとしてできるだけ素早く正解を見出していくためには、「目に見えない部分に対する前段階の準備力」がポイントとなっていくのではないかと私は考えております（昨今のコロナ禍の中ではリモートワークが主体になっている状況もあり、私自身も改めてその大切さを痛感している次第です）。

アプリUI実装と機能ロジックをコラボしていく過程の中で、UI実装に関する部分は1つの決まった答えがあるわけでもなく、正解を見出すまでの試行錯誤の過程はシビアで泥臭く突き詰めていかなければならない場面も多々あると思います。実現するためのアイデアや方針を立てていく際に、デザインデータや仕様書といった情報を紐解く過程の中で生まれた些細な疑問点や自分であればこの様な実装を考えていくという小さなアイデアといった点を、できるだけ自分の言葉で言語化したものを簡単でも構わないのでまとめたものを細かく共有する様に心がけていくと良さそうに感じています。

そして私自身、UI実装のアイデアを考える際における最初の1歩が「自分が気になったUI実装やあのアプリでの表現」という小さなキッカケであることが多く、その感覚や認識を頭の片隅におきながら具体的な実装を紐解くためのアプローチや設計方針・コードとしての実現方法を覗きながらその機能やUIとしての美しさの琴線に触れながら、アプリUI実装と機能ロジックの調和が取れたユーザーの心に残る形を実現していくことが、iOSアプリ開発におけるUI実装の醍醐味の1つであると考えております。

本稿に執筆に当たり現在私が業務委託としてiOS/Androidアプリ開発に携わらせて頂いております株式会社グロービス様での業務内での事例を今回は紹介をしております。この場をお借りして感謝を意を述べさせて頂きます。アプリの機能やデザインを考えて行く際において、チームの皆様を巻き込みながら、数多くの議論やご相談の機会をしっかりと設けて頂きながら磨き上げていくプロセスは本当に私自身も発見が多く勉強になっております。そして最後までお読み頂きまして本当にありがとうございました。
